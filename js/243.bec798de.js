(self["define"]=self["define"]||[]).push([[243],{76392:function(e){!function(t,n){e.exports=n()}(0,(function(){"use strict";var e=1e3,t=6e4,n=36e5,a="millisecond",i="second",r="minute",s="hour",o="day",l="week",u="month",c="quarter",d="year",h="date",f="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,w=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e,t,n){var a=String(e);return!a||a.length>=t?e:""+Array(t+1-a.length).join(n)+e},g={s:m,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),a=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+m(a,2,"0")+":"+m(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var a=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(a,u),r=n-i<0,s=t.clone().add(a+(r?-1:1),u);return+(-(a+(n-i)/(r?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:l,d:o,D:h,h:s,m:r,s:i,ms:a,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=p;var E=function(e){return e instanceof C},_=function(e,t,n){var a;if(!e)return y;if("string"==typeof e)b[e]&&(a=e),t&&(b[e]=t,a=e);else{var i=e.name;b[i]=e,a=i}return!n&&a&&(y=a),a||!n&&y},k=function(e,t){if(E(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new C(n)},$=g;$.l=_,$.i=E,$.w=function(e,t){return k(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var C=function(){function p(e){this.$L=_(e.locale,null,!0),this.parse(e)}var m=p.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if($.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var a=t.match(v);if(a){var i=a[2]-1||0,r=(a[7]||"0").substring(0,3);return n?new Date(Date.UTC(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,r)):new Date(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,r)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return $},m.isValid=function(){return!(this.$d.toString()===f)},m.isSame=function(e,t){var n=k(e);return this.startOf(t)<=n&&n<=this.endOf(t)},m.isAfter=function(e,t){return k(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<k(e)},m.$g=function(e,t,n){return $.u(e)?this[t]:this.set(n,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var n=this,a=!!$.u(t)||t,c=$.p(e),f=function(e,t){var i=$.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return a?i:i.endOf(o)},v=function(e,t){return $.w(n.toDate()[e].apply(n.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},w=this.$W,p=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(c){case d:return a?f(1,0):f(31,11);case u:return a?f(1,p):f(0,p+1);case l:var y=this.$locale().weekStart||0,b=(w<y?w+7:w)-y;return f(a?m-b:m+(6-b),p);case o:case h:return v(g+"Hours",0);case s:return v(g+"Minutes",1);case r:return v(g+"Seconds",2);case i:return v(g+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var n,l=$.p(e),c="set"+(this.$u?"UTC":""),f=(n={},n[o]=c+"Date",n[h]=c+"Date",n[u]=c+"Month",n[d]=c+"FullYear",n[s]=c+"Hours",n[r]=c+"Minutes",n[i]=c+"Seconds",n[a]=c+"Milliseconds",n)[l],v=l===o?this.$D+(t-this.$W):t;if(l===u||l===d){var w=this.clone().set(h,1);w.$d[f](v),w.init(),this.$d=w.set(h,Math.min(this.$D,w.daysInMonth())).$d}else f&&this.$d[f](v);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[$.p(e)]()},m.add=function(a,c){var h,f=this;a=Number(a);var v=$.p(c),w=function(e){var t=k(f);return $.w(t.date(t.date()+Math.round(e*a)),f)};if(v===u)return this.set(u,this.$M+a);if(v===d)return this.set(d,this.$y+a);if(v===o)return w(1);if(v===l)return w(7);var p=(h={},h[r]=t,h[s]=n,h[i]=e,h)[v]||1,m=this.$d.getTime()+a*p;return $.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var a=e||"YYYY-MM-DDTHH:mm:ssZ",i=$.z(this),r=this.$H,s=this.$m,o=this.$M,l=n.weekdays,u=n.months,c=function(e,n,i,r){return e&&(e[n]||e(t,a))||i[n].substr(0,r)},d=function(e){return $.s(r%12||12,e,"0")},h=n.meridiem||function(e,t,n){var a=e<12?"AM":"PM";return n?a.toLowerCase():a},v={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:$.s(o+1,2,"0"),MMM:c(n.monthsShort,o,u,3),MMMM:c(u,o),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(r),HH:$.s(r,2,"0"),h:d(1),hh:d(2),a:h(r,s,!0),A:h(r,s,!1),m:String(s),mm:$.s(s,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:i};return a.replace(w,(function(e,t){return t||v[e]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(a,h,f){var v,w=$.p(h),p=k(a),m=(p.utcOffset()-this.utcOffset())*t,g=this-p,y=$.m(this,p);return y=(v={},v[d]=y/12,v[u]=y,v[c]=y/3,v[l]=(g-m)/6048e5,v[o]=(g-m)/864e5,v[s]=g/n,v[r]=g/t,v[i]=g/e,v)[w]||g,f?y:$.a(y)},m.daysInMonth=function(){return this.endOf(u).$D},m.$locale=function(){return b[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),a=_(e,t,!0);return a&&(n.$L=a),n},m.clone=function(){return $.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},p}(),D=C.prototype;return k.prototype=D,[["$ms",a],["$s",i],["$m",r],["$H",s],["$W",o],["$M",u],["$y",d],["$D",h]].forEach((function(e){D[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),k.extend=function(e,t){return e.$i||(e(t,C,k),e.$i=!0),k},k.locale=_,k.isDayjs=E,k.unix=function(e){return k(1e3*e)},k.en=b[y],k.Ls=b,k.p={},k}))},86022:function(e,t,n){"use strict";n(21703);const a=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),i=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:t,willResolve:n})=>(a,{value:r,signal:s}={})=>{if(s&&s.aborted)return Promise.reject(i());let o,l,u;const c=e||clearTimeout,d=()=>{c(o),u(i())},h=()=>{s&&s.removeEventListener("abort",d)},f=new Promise(((e,i)=>{l=()=>{h(),n?e(r):i(r)},u=i,o=(t||setTimeout)(l,a)}));return s&&s.addEventListener("abort",d,{once:!0}),f.clear=()=>{c(o),o=null,l()},f},s=e=>{const t=r({...e,willResolve:!0});return t.reject=r({...e,willResolve:!1}),t.range=(e,n,i)=>t(a(e,n),i),t},o=s();o.createWithTimers=s,e.exports=o,e.exports["default"]=o},86463:function(e,t,n){"use strict";n(21703);var a=n(14455);function i(e,t,n){if("function"===typeof e&&(n=t,t=e,e=null),n<1)throw new Error("fastqueue concurrency must be greater than 1");var i=a(s),o=null,l=null,u=0,c=null,d={push:g,drain:r,saturated:r,pause:f,paused:!1,concurrency:n,running:h,resume:p,idle:m,length:v,getQueue:w,unshift:y,empty:r,kill:E,killAndDrain:_,error:k};return d;function h(){return u}function f(){d.paused=!0}function v(){var e=o,t=0;while(e)e=e.next,t++;return t}function w(){var e=o,t=[];while(e)t.push(e.value),e=e.next;return t}function p(){if(d.paused){d.paused=!1;for(var e=0;e<d.concurrency;e++)u++,b()}}function m(){return 0===u&&0===d.length()}function g(n,a){var s=i.get();s.context=e,s.release=b,s.value=n,s.callback=a||r,s.errorHandler=c,u===d.concurrency||d.paused?l?(l.next=s,l=s):(o=s,l=s,d.saturated()):(u++,t.call(e,s.value,s.worked))}function y(n,a){var s=i.get();s.context=e,s.release=b,s.value=n,s.callback=a||r,u===d.concurrency||d.paused?o?(s.next=o,o=s):(o=s,l=s,d.saturated()):(u++,t.call(e,s.value,s.worked))}function b(n){n&&i.release(n);var a=o;a?d.paused?u--:(l===o&&(l=null),o=a.next,a.next=null,t.call(e,a.value,a.worked),null===l&&d.empty()):0===--u&&d.drain()}function E(){o=null,l=null,d.drain=r}function _(){o=null,l=null,d.drain(),d.drain=r}function k(e){c=e}}function r(){}function s(){this.value=null,this.callback=r,this.next=null,this.release=r,this.context=null,this.errorHandler=null;var e=this;this.worked=function(t,n){var a=e.callback,i=e.errorHandler,s=e.value;e.value=null,e.callback=r,e.errorHandler&&i(t,s),a.call(e.context,t,n),e.release(e)}}function o(e,t,n){function a(e,n){t.call(this,e).then((function(e){n(null,e)}),n)}"function"===typeof e&&(n=t,t=e,e=null);var s=i(e,a,n),o=s.push,l=s.unshift;return s.push=u,s.unshift=c,s.drained=d,s;function u(e){var t=new Promise((function(t,n){o(e,(function(e,a){e?n(e):t(a)}))}));return t.catch(r),t}function c(e){var t=new Promise((function(t,n){l(e,(function(e,a){e?n(e):t(a)}))}));return t.catch(r),t}function d(){var e=s.drain,t=new Promise((function(t){s.drain=function(){e(),t()}}));return t}}e.exports=i,e.exports.promise=o},47749:function(e,t,n){n(21703),function(t,n){e.exports=n()}(0,(function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={type:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},isObject:function(e,t){return t?"object"===this.type(e):e&&"object"===("undefined"===typeof e?"undefined":a(e))},isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},encode:function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},formatParams:function(e){var t="",n=!0,a=this;if(!this.isObject(e))return e;function i(e,r){var s=a.encode,o=a.type(e);if("array"==o)e.forEach((function(e,t){a.isObject(e)||(t=""),i(e,r+"%5B"+t+"%5D")}));else if("object"==o)for(var l in e)i(e[l],r?r+"%5B"+s(l)+"%5D":s(l));else n||(t+="&"),n=!1,t+=r+"="+s(e)}return i(e,""),t},merge:function(e,t){for(var n in t)e.hasOwnProperty(n)?this.isObject(t[n],1)&&this.isObject(e[n],1)&&this.merge(e[n],t[n]):e[n]=t[n];return e}}},,function(e,t,n){var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),s="undefined"!==typeof document,o=function(){function e(t){function n(e){var t=void 0,n=void 0;function a(){e.p=t=n=null}r.merge(e,{lock:function(){t||(e.p=new Promise((function(e,a){t=e,n=a})))},unlock:function(){t&&(t(),a())},clear:function(){n&&(n("cancel"),a())}})}i(this,e),this.engine=t||XMLHttpRequest,this.default=this;var a=this.interceptors={response:{use:function(e,t){this.handler=e,this.onerror=t}},request:{use:function(e){this.handler=e}}},s=a.request,o=a.response;n(o),n(s),this.config={method:"GET",baseURL:"",headers:{},timeout:0,params:{},parseJson:!0,withCredentials:!1}}return a(e,[{key:"request",value:function(e,t,n){var a=this,i=new this.engine,o="Content-Type",l=o.toLowerCase(),u=this.interceptors,c=u.request,d=u.response,h=c.handler,f=new Promise((function(u,f){function v(e){return e&&e.then&&e.catch}function w(e,t){e?e.then((function(){t()})):t()}function p(n){t=n.body,e=r.trim(n.url);var a=r.trim(n.baseURL||"");if(e||!s||a||(e=location.href),0!==e.indexOf("http")){var c="/"===e[0];if(!a&&s){var h=location.pathname.split("/");h.pop(),a=location.protocol+"//"+location.host+(c?"":h.join("/"))}if("/"!==a[a.length-1]&&(a+="/"),e=a+(c?e.substr(1):e),s){var p=document.createElement("a");p.href=e,e=p.href}}var m=r.trim(n.responseType||""),g=-1!==["GET","HEAD","DELETE","OPTION"].indexOf(n.method),y=r.type(t),b=n.params||{};g&&"object"===y&&(b=r.merge(t,b)),b=r.formatParams(b);var E=[];b&&E.push(b),g&&t&&"string"===y&&E.push(t),E.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+E.join("&")),i.open(n.method,e);try{i.withCredentials=!!n.withCredentials,i.timeout=n.timeout||0,"stream"!==m&&(i.responseType=m)}catch(S){}var _=n.headers[o]||n.headers[l],k="application/x-www-form-urlencoded";for(var $ in r.trim((_||"").toLowerCase())===k?t=r.formatParams(t):r.isFormData(t)||-1===["object","array"].indexOf(r.type(t))||(k="application/json;charset=utf-8",t=JSON.stringify(t)),_||g||(n.headers[o]=k),n.headers)if($===o&&r.isFormData(t))delete n.headers[$];else try{i.setRequestHeader($,n.headers[$])}catch(S){}function C(e,t,a){w(d.p,(function(){if(e){a&&(t.request=n);var i=e.call(d,t,Promise);t=void 0===i?t:i}v(t)||(t=Promise[0===a?"resolve":"reject"](t)),t.then((function(e){u(e)})).catch((function(e){f(e)}))}))}function D(e){e.engine=i,C(d.onerror,e,-1)}function x(e,t){this.message=e,this.status=t}i.onload=function(){try{var e=i.response||i.responseText;e&&n.parseJson&&-1!==(i.getResponseHeader(o)||"").indexOf("json")&&!r.isObject(e)&&(e=JSON.parse(e));var t=i.responseHeaders;if(!t){t={};var a=(i.getAllResponseHeaders()||"").split("\r\n");a.pop(),a.forEach((function(e){if(e){var n=e.split(":")[0];t[n]=i.getResponseHeader(n)}}))}var s=i.status,l=i.statusText,u={data:e,headers:t,status:s,statusText:l};if(r.merge(u,i._response),s>=200&&s<300||304===s)u.engine=i,u.request=n,C(d.handler,u,0);else{var c=new x(l,s);c.response=u,D(c)}}catch(c){D(new x(c.msg,i.status))}},i.onerror=function(e){D(new x(e.msg||"Network Error",0))},i.ontimeout=function(){D(new x("timeout [ "+i.timeout+"ms ]",1))},i._options=n,setTimeout((function(){i.send(g?null:t)}),0)}r.isObject(e)&&(n=e,e=n.url),n=n||{},n.headers=n.headers||{},w(c.p,(function(){r.merge(n,JSON.parse(JSON.stringify(a.config)));var i=n.headers;i[o]=i[o]||i[l]||"",delete i[l],n.body=t||n.body,e=r.trim(e||""),n.method=n.method.toUpperCase(),n.url=e;var s=n;h&&(s=h.call(c,n,Promise)||n),v(s)||(s=Promise.resolve(s)),s.then((function(e){e===n?p(e):u(e)}),(function(e){f(e)}))}))}));return f.engine=i,f}},{key:"all",value:function(e){return Promise.all(e)}},{key:"spread",value:function(e){return function(t){return e.apply(null,t)}}}]),e}();o.default=o,["get","post","put","patch","head","delete"].forEach((function(e){o.prototype[e]=function(t,n,a){return this.request(t,n,r.merge({method:e},a))}})),["lock","unlock","clear"].forEach((function(e){o.prototype[e]=function(){this.interceptors.request[e]()}})),e.exports=o}])}))},14455:function(e){"use strict";function t(e){var t=new e,n=t;function a(){var a=t;return a.next?t=a.next:(t=new e,n=t),a.next=null,a}function i(e){n.next=e,n=e}return{get:a,release:i}}e.exports=t},12507:function(e,t,n){"use strict";n.d(t,{Q8:function(){return a},eW:function(){return i},rT:function(){return r}});n(48675),n(3462),n(21703);function a(e){return{rows:e.height,cols:e.width,type:24,data:new Uint8Array(e.data)}}function i(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");if(!n)throw new Error('canvas.getContext("2d") failed');return n.drawImage(e,0,0),a(n.getImageData(0,0,e.width,e.height))}function r(e){if(24!==e.type)throw new Error(`Converting type ${e.type} to canvas faild. Only CV_8UC4 is supported.`);const t=document.createElement("canvas");t.width=e.cols,t.height=e.rows;const n=t.getContext("2d");if(!n)throw new Error("Could not get context");const a=n.createImageData(e.cols,e.rows);return a.data.set(e.data),n.putImageData(a,0,0),t}},45161:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});n(77610);var a=n(69417),i=n(19812),r=n(55893);function s(e,t,n,s,o,l){const u=a.Q0;return(0,i.wg)(),(0,i.j4)(u,{content:s.buildDesc,"raw-content":""},{default:(0,i.w5)((()=>[(0,i.Uk)("#"+(0,r.zw)(s.buildTime),1)])),_:1},8,["content"])}var o=n(76392),l=n.n(o),u={setup(){const e=l()(Number("1648521392922")),t="829b5cf6",n="null";return{buildTime:"2203291036",buildDesc:`#${t} - ${e.format("YYYY-MM-DD HH:mm:ss")}${n?"<br/ >"+n.replace(/\n/g,"<br>"):""}`}}},c=n(48998);const d=(0,c.Z)(u,[["render",s]]);var h=d},77225:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var a=n(19812),i=n(55893);const r={key:0,class:"wait-page"},s=(0,a.Uk)("请切换到游戏窗口"),o=(0,a._)("br",null,null,-1),l=(0,a.Uk)('打开"天地万象"页面'),u=[s,o,l],c=(0,a._)("div",{class:"icon"},null,-1),d={class:"text"},h={class:"count"},f={class:"scanned"},v=(0,a._)("div",{class:"title"},"扫描",-1),w={class:"number"},p={class:"success"},m=(0,a._)("div",{class:"title"},"成功",-1),g={class:"number"},y={class:"faild"},b=(0,a._)("div",{class:"title"},"失败",-1),E={class:"number"},_={class:"dup"},k=(0,a._)("div",{class:"title"},"重复",-1),$={class:"number"},C=(0,a._)("div",{class:"desc"},[(0,a.Uk)("慢慢向下翻页"),(0,a._)("br"),(0,a.Uk)("到达底端后点击此处结束")],-1);function D(e,t,n,s,o,l){return(0,a.wg)(),(0,a.iD)("div",null,[0===e.state?((0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",{class:(0,i.C_)(e.$style.icon)},null,2),(0,a._)("div",{class:(0,i.C_)(e.$style.text)},u,2)])):(0,a.kq)("",!0),1===e.state?((0,a.wg)(),(0,a.iD)("div",{key:1,class:(0,i.C_)(e.$style.downPage)},[c,(0,a._)("div",d,[(0,a._)("div",h,[(0,a._)("div",f,[v,(0,a._)("div",w,(0,i.zw)(e.scanned),1)]),(0,a._)("div",p,[m,(0,a._)("div",g,(0,i.zw)(e.success),1)]),(0,a._)("div",y,[b,(0,a._)("div",E,(0,i.zw)(e.fail),1)]),(0,a._)("div",_,[k,(0,a._)("div",$,(0,i.zw)(e.duplicate),1)])]),C])],2)):(0,a.kq)("",!0)])}var x=(0,a.aZ)({props:{state:Number,success:Number,fail:Number,duplicate:Number,scanned:Number,capture:Boolean,inFloat:{type:Boolean,default:!0}},setup(e){if(e.inFloat){const t=(0,a.f3)("refresh");(0,a.YP)((()=>e),(async()=>{await(0,a.Y3)(),t&&t()}),{deep:!0}),(0,a.bv)((async()=>{console.log("onmounted"),await(0,a.Y3)(),t&&t()}))}return{}}}),S={icon:"icon-fea061",text:"text-f8f0b9",downPage:"down-page-b54cbd"},M=n(48998);const T={};T["$style"]=S;const O=(0,M.Z)(x,[["render",D],["__cssModules",T]]);var P=O},77619:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Fe}});var a=n(19812),i=n(55893),r=n(97690);const s={key:0},o={key:1},l={ref:"video",style:{display:"none"}},u={key:0},c=(0,a._)("div",{class:"desc"},"点击开始后，请按下图指示选择原神窗口以识别",-1),d=(0,a._)("img",{src:r,alt:"请参照图片开始抓屏"},null,-1),h={class:"inline-status"},f={key:0,class:"no-box"},v={key:1,class:"pbar"},w={key:0,class:"pbar-bar-text"},p=(0,a.Uk)(" 我已切换到成就页面（自动识别页面未完成） "),m=(0,a._)("br",null,null,-1),g=(0,a.Uk)(" 点击后会自动切换到原神窗口并开始自动翻页，请确保已经完成页面切换再回来 "),y=(0,a._)("br",null,null,-1),b=(0,a.Uk)("如没看到悬浮窗请点击窗口空白处 "),E={key:0},_=["src"],k={key:1,class:"title"};function $(e,t,n,r,$,C){const D=(0,a.up)("Loader"),x=(0,a.up)("webcontrol-switch"),S=(0,a.up)("FooterComponent"),M=(0,a.up)("float-content-b"),T=(0,a.up)("float-window"),O=(0,a.up)("float-content");return(0,a.wg)(),(0,a.iD)("main",null,[e.state===e.S.Init?((0,a.wg)(),(0,a.iD)("section",s,[(0,a.Wm)(D,{onDone:t[0]||(t[0]=t=>e.state++)})])):((0,a.wg)(),(0,a.iD)("section",o,[(0,a._)("video",l,null,512),e.state<e.S.Wait?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,i.C_)(e.$style.startPage)},[e.isTop?((0,a.wg)(),(0,a.iD)("h1",u,"椰羊·成就扫描")):(0,a.kq)("",!0),(0,a._)("button",{class:"start",onClick:t[1]||(t[1]=(...t)=>e.requestCapture&&e.requestCapture(...t))},"开始"),(0,a.Wm)(x,{modelValue:e.webControlEnabled,"onUpdate:modelValue":t[2]||(t[2]=t=>e.webControlEnabled=t),w:e.webControl},null,8,["modelValue","w"]),c,d,(0,a.Wm)(S)],2)):(0,a.kq)("",!0),e.state===e.S.Wait||e.state===e.S.Capture?((0,a.wg)(),(0,a.j4)(T,{key:1,width:250,height:100,class:(0,i.C_)(e.$style.floatwindow),onExit:t[3]||(t[3]=t=>e.state=e.S.Processing)},{default:(0,a.w5)((()=>[(0,a.Wm)(M,{capture:e.capture,state:e.state===e.S.Capture?1:0,success:e.recognized.success,fail:e.recognized.fail,scanned:e.scanned,duplicate:e.dup,webControlEnabled:e.webControlEnabled},null,8,["capture","state","success","fail","scanned","duplicate","webControlEnabled"])])),_:1},8,["class"])):(0,a.kq)("",!0),e.state>e.S.Wait?((0,a.wg)(),(0,a.iD)("div",{key:2,class:(0,i.C_)(e.$style.statusInner)},[(0,a._)("div",h,[(0,a.Wm)(O,{"in-float":!1,capture:!1,state:1,success:e.recognized.success,fail:e.recognized.fail,scanned:e.scanned,duplicate:e.dup,onClick:t[4]||(t[4]=t=>e.state===e.S.Capture&&(e.state=e.S.Processing))},null,8,["success","fail","scanned","duplicate"])]),e.state===e.S.Capture?((0,a.wg)(),(0,a.iD)("div",f,(0,i.zw)(e.webControlEnabled?"自动滚动进行中":"请按悬浮窗提示滚动页面"),1)):(0,a.kq)("",!0),e.state>e.S.Capture?((0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("div",{class:(0,i.C_)(["pbar-bar",{finish:e.state===e.S.Finish}])},[(0,a._)("div",{class:"pbar-bar-in",style:(0,i.j5)({width:(e.recognized.success+e.recognized.fail+e.dup)/e.scanned*100+"%"})},null,4),e.state===e.S.Finish?((0,a.wg)(),(0,a.iD)("div",w,"完成")):(0,a.kq)("",!0)],2),e.state===e.S.Finish?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"restart",onClick:t[5]||(t[5]=(...t)=>e.reset&&e.reset(...t))},"重新开始")):(0,a.kq)("",!0)])):(0,a.kq)("",!0)],2)):(0,a.kq)("",!0),e.state===e.S.Wait?((0,a.wg)(),(0,a.iD)("button",{key:3,style:{display:"block",margin:"0 auto","margin-top":"10vh"},onClick:t[6]||(t[6]=t=>e.state=e.S.Capture)},[p,e.webControlEnabled?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[m,g],64)):(0,a.kq)("",!0),y,b])):(0,a.kq)("",!0),e.isTop?((0,a.wg)(),(0,a.iD)("div",{key:4,class:(0,i.C_)(e.$style.list)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.results,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"item"},[e.success?((0,a.wg)(),(0,a.iD)("div",k,(0,i.zw)(e.achievement.name)+" "+(0,i.zw)(e.date||"未完成"),1)):((0,a.wg)(),(0,a.iD)("div",E,[(0,a._)("img",{src:e.images.main},null,8,_)]))])))),128))],2)):(0,a.kq)("",!0)]))])}n(85827),n(21703);var C=n(78255),D=n(47749),x=n.n(D);class S{constructor(e=32333){(0,C.Z)(this,"port",32333),(0,C.Z)(this,"token",""),(0,C.Z)(this,"hwnd",0),(0,C.Z)(this,"version",""),(0,C.Z)(this,"client",new(x())),(0,C.Z)(this,"MOUSEEVENTF_ABSOLUTE",32768),(0,C.Z)(this,"MOUSEEVENTF_LEFTDOWN",2),(0,C.Z)(this,"MOUSEEVENTF_LEFTUP",4),(0,C.Z)(this,"MOUSEEVENTF_MIDDLEDOWN",32),(0,C.Z)(this,"MOUSEEVENTF_MIDDLEUP",64),(0,C.Z)(this,"MOUSEEVENTF_MOVE",1),(0,C.Z)(this,"MOUSEEVENTF_RIGHTDOWN",8),(0,C.Z)(this,"MOUSEEVENTF_RIGHTUP",16),(0,C.Z)(this,"MOUSEEVENTF_WHEEL",2048),(0,C.Z)(this,"MOUSEEVENTF_XDOWN",128),(0,C.Z)(this,"MOUSEEVENTF_XUP",256),(0,C.Z)(this,"MOUSEEVENTF_HWHEEL",4096),this.port=e,this.client.config.baseURL=`http://localhost:${this.port}`,this.client.interceptors.request.use((e=>(this.token&&(e.headers["Authorization"]=`Bearer ${this.token}`),""===e.headers["Content-Type"]&&delete e.headers["Content-Type"],e))),this.client.interceptors.response.use(void 0,(e=>{const t=e;return 410===t.status?(console.warn("Control stopped by user"),new Error("ECANCEL")):e}))}async check(){try{const{data:e}=await this.client.get("/",{},{timeout:800});return this.version=e.version,!0}catch(e){return!1}}async authorize(){try{const{data:e}=await this.client.post("/token");return this.token=e.token,this.hwnd=e.hwnd||0,!0}catch(e){const t=e;if(401===t.status)return!1;throw e}}async mouse_event(e,t,n,a,i=1){return this.client.post("/api/mouse_event",{},{params:{dwFlags:e,dx:t,dy:n,dwData:a,repeat:i}})}async keybd_event(e,t,n){return this.client.post("/api/keybd_event",{},{params:{bVk:e,bScan:t,dwFlags:n}})}async sendMessage(e,t,n,a){return this.client.post("/api/SendMessage",{},{params:{hWnd:e,Msg:t,wParam:n,lParam:a}})}async SetCursorPos(e,t){return this.client.post("/api/SetCursorPos",{},{params:{x:e,y:t}})}async listWindows(){return(await this.client.get("/api/windows")).data}async getWindow(e){return(await this.client.get("/api/windows/"+e)).data}async activeWindow(e){return await this.client.patch("/api/windows/"+e,{},{})}async getMonitor(){return(await this.client.get("/api/monitors")).data}async toAbsolute(e,t,n,{dx:a=1,dy:i=1}={dx:1,dy:1}){const r=await this.getWindow(e),s=1===a?1:r.width/a,o=1===i?1:r.height/i;return console.log({x:t*s,y:n*o}),{x:t*s+r.x,y:n*o+r.y}}}var M=n(12507),T=n(54063),O=n(20521);const P=["width","height"];function F(e,t,n,r,s,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",{class:(0,i.C_)(e.$style.floatContent)},[(0,a.WI)(e.$slots,"default")],2),(0,a._)("canvas",{ref:"canvas",width:2*e.width,height:2*e.height,class:(0,i.C_)(e.$style.floatCanvas),style:(0,i.j5)({width:`${e.width}px`,height:`${e.height}px`})},null,14,P),(0,a._)("video",{ref:"video",autoplay:"",class:(0,i.C_)(e.$style.floatVideo),style:(0,i.j5)({width:`${e.width}px`,height:`${e.height}px`}),onLeavepictureinpicture:t[0]||(t[0]=t=>e.$emit("exit"))},null,38)])}var L=(0,a.aZ)({props:{width:Number,height:Number},emits:["exit"],setup(){let e=!1;const t=(0,O.iH)(null),n=(0,O.iH)(null);let i;(0,a.JJ)("canvas",n);const r=async()=>{if(e||(i=n.value.captureStream(),t.value.srcObject=i,e=!0),null===document.pictureInPictureElement)try{await t.value.play(),await t.value.requestPictureInPicture()}catch(a){document.addEventListener("mousedown",(async()=>{await t.value.play(),await t.value.requestPictureInPicture()}),{once:!0})}};return(0,a.bv)(r),(0,a.Jd)((()=>{t.value&&(t.value.srcObject=null),i&&i.getTracks().forEach((e=>e.stop()));try{document.pictureInPictureElement===t.value&&document.exitPictureInPicture()}catch(e){}})),{init:r,video:t,canvas:n}}}),U={floatContent:"float-content-f4ac7b",floatCanvas:"float-canvas-f269e2",floatVideo:"float-video-c5d6ef"},H=n(48998);const N={};N["$style"]=U;const I=(0,H.Z)(L,[["render",F],["__cssModules",N]]);var W=I,j=n(77225);function q(e,t,n,i,r,s){return(0,a.wg)(),(0,a.iD)("div")}const V="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1024 1024' fill='%23fff'%3E%3Cpath d='M421.646 361.414v-93.081c0-7.562 2.678-13.996 8.038-19.366 5.354-5.346 11.812-8.022 19.366-8.022h246.373c7.562 0 14.012 2.676 19.356 8.022 5.37 5.372 8.038 11.804 8.038 19.366v246.405c0 7.554-2.668 13.988-8.038 19.358-5.346 5.328-11.794 8.024-19.356 8.024H602.35v202.605c0 10.576-3.736 19.582-11.254 27.102-7.484 7.462-16.514 11.232-27.1 11.232H219.07c-10.574 0-19.616-3.77-27.112-11.232-7.508-7.52-11.254-16.526-11.254-27.102V399.758c0-10.588 3.748-19.594 11.254-27.112 7.496-7.484 16.538-11.232 27.112-11.232h202.573zm0 60.234H279.31c-10.574 0-19.618 3.748-27.112 11.232-7.508 7.52-11.254 16.526-11.254 27.112v224.497c0 10.576 3.748 19.582 11.254 27.102 7.494 7.462 16.538 11.232 27.112 11.232h224.455c10.586 0 19.616-3.77 27.1-11.232 7.52-7.52 11.254-16.526 11.254-27.102V542.118h-93.066c-7.554 0-14.012-2.694-19.366-8.024-5.362-5.37-8.038-11.804-8.038-19.358v-93.088zm87.64-120.47c-7.554 0-14.012 2.678-19.366 8.024-5.362 5.37-8.038 11.804-8.038 19.368v125.936c0 7.554 2.678 13.988 8.038 19.358 5.354 5.33 11.812 8.024 19.366 8.024h125.906c7.562 0 14.012-2.694 19.356-8.024 5.37-5.37 8.037-11.804 8.037-19.358V328.57c0-7.562-2.667-13.996-8.037-19.368-5.346-5.346-11.794-8.024-19.356-8.024H509.288zM225.169 85.038l-49.932-28.83c-14.406-8.319-19.342-26.737-11.024-41.14s26.736-19.343 41.14-11.025l104.332 60.234c14.404 8.318 19.342 26.736 11.024 41.14L260.473 209.75c-8.318 14.406-26.736 19.342-41.14 11.024s-19.342-26.736-11.024-41.14l23.282-40.326c-40.44 15.522-74.804 37.426-103.092 65.712-42.704 42.704-71.337 99.733-85.903 171.087L.002 333.512c14.744-71.535 43.36-128.545 85.85-171.037 36.211-36.212 82.65-62.026 139.315-77.442zm536.998 808.386l49.932 28.828c14.404 8.318 19.342 26.736 11.024 41.14s-26.736 19.342-41.14 11.024L677.651 914.18c-14.404-8.318-19.341-26.736-11.024-41.14l60.236-104.331c8.318-14.404 26.736-19.342 41.14-11.024s19.342 26.736 11.024 41.14l-23.282 40.326c40.44-15.52 74.804-37.424 103.092-65.712 42.704-42.704 71.338-99.734 85.904-171.09l42.591 42.592c-14.744 71.534-43.36 128.548-85.85 171.038-36.211 36.212-82.649 62.025-139.315 77.441z'/%3E%3C/svg%3E",Z="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1024 1024' fill='%23fff'%3E%3Cpath d='M468.867 212.468a43.133 43.133 0 1 0 86.266 0 43.133 43.133 0 1 0-86.266 0zM468.867 383.4a43.133 43.133 0 1 0 86.266 0 43.133 43.133 0 1 0-86.266 0zM468.867 554.334a43.133 43.133 0 1 0 86.266 0 43.133 43.133 0 1 0-86.266 0zM609.448 651.782L512 749.229l-97.448-97.447c-17.572-17.573-43.132-17.573-59.107 0s-17.573 43.132 0 59.107l127.8 127.8c7.987 7.988 20.767 12.78 30.353 12.78s20.767-4.792 30.352-12.78l127.8-127.8c17.573-17.572 17.573-43.132 0-59.107-19.17-17.573-44.73-17.573-62.302 0z'/%3E%3Cpath d='M555.133 0h-84.668C302.727 0 171.732 132.593 171.732 298.733v426.534c0 166.14 132.592 298.733 298.733 298.733h84.668c166.14 0 298.733-132.593 298.733-298.733V298.733C852.268 132.593 721.273 0 555.133 0zM767.6 723.67c0 119.812-94.253 212.467-212.468 212.467h-84.668c-119.813 0-212.468-94.252-212.468-212.468V298.733c0-119.813 94.253-212.468 212.468-212.468h84.668c119.812 0 212.468 94.253 212.468 212.468V723.67z'/%3E%3C/svg%3E",z=new Image;z.src=V;const R=new Image;R.src=Z;var A=(0,a.aZ)({props:{state:Number,success:Number,fail:Number,duplicate:Number,scanned:Number,webControlEnabled:Number},setup(e){const t=(0,a.f3)("canvas");function n(){const e=t.value.getContext("2d");e.textAlign="left",e.fillStyle="#fff",e.fillRect(0,0,t.value.width,t.value.height),e.fillStyle="#7e7e7e",e.fillRect(0,0,.28*t.value.width,t.value.height),e.drawImage(z,.05*t.value.width,.112*t.value.width,.18*t.value.width,.18*t.value.width),e.fillStyle="#999",e.font=.056*t.value.width+"px 微软雅黑",e.fillText("请切换到游戏窗口",.42*t.value.width,.18*t.value.width),e.fillText("打开任意成就页面",.42*t.value.width,.26*t.value.width)}function i(){const n=t.value.getContext("2d");n.textAlign="left",n.fillStyle="#fff",n.fillRect(0,0,t.value.width,t.value.height),n.fillStyle="#4096fe",n.fillRect(0,0,.28*t.value.width,t.value.height),n.drawImage(R,.05*t.value.width,.112*t.value.width,.18*t.value.width,.18*t.value.width),n.font=.044*t.value.width+"px 微软雅黑",e.webControlEnabled&&e.webControlEnabled>0?(n.fillText("自动翻页进行中，请勿移动鼠标",.348*t.value.width,.292*t.value.width),n.fillText("如需中断，请按Win键停止识别",.356*t.value.width,.352*t.value.width)):(n.fillText("匀速向下翻页 完成后点此结束",.348*t.value.width,.292*t.value.width),n.fillText("尽量将鼠标保持在左侧图标处",.356*t.value.width,.352*t.value.width)),n.fillText("扫描",.34*t.value.width,.092*t.value.width),n.fillStyle="#00b57a",n.fillText("成功",.508*t.value.width,.092*t.value.width),n.fillStyle="#cf0000",n.fillText("失败",.676*t.value.width,.092*t.value.width),n.fillStyle="#999",n.fillText("重复",.844*t.value.width,.092*t.value.width),r()}function r(){if(0===e.state)return;const n=t.value.getContext("2d");n.fillStyle="#fff",n.fillRect(.28*t.value.width,.112*t.value.width,.72*t.value.width,.12*t.value.width),n.font=.08*t.value.width+"px 微软雅黑",n.textAlign="center",n.fillStyle="#4096fe",n.fillText((e.scanned||0).toString(),.38*t.value.width,.2*t.value.width),n.fillStyle="#00b57a",n.fillText((e.success||0).toString(),.552*t.value.width,.2*t.value.width),n.fillStyle="#cf0000",n.fillText((e.fail||0).toString(),.72*t.value.width,.2*t.value.width),n.fillStyle="#999",n.fillText((e.duplicate||0).toString(),.888*t.value.width,.2*t.value.width)}return(0,a.YP)((()=>e.state),(e=>{0===e?n():i()})),(0,a.YP)(e,(()=>{r()}),{deep:!0}),(0,a.bv)((()=>{0===e.state?n():i()})),{}}});const Y=(0,H.Z)(A,[["render",q]]);var B=Y;const J={key:0,href:"javascript:"},Q={class:"model"},G={class:"title"},X={key:0},K={class:"content"},ee=(0,a.Uk)(" 由于浏览器限制，自动滚动无法在网页完成 "),te=(0,a._)("a",{class:"dlink",href:"/assets/cocogoat-control-1.0.4.exe",target:"_blank"},[(0,a.Uk)(" 点击此处下载客户端"),(0,a._)("br"),(0,a._)("small",null,"(v1.0.4 140kB)")],-1);function ne(e,t,n,r,s,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",{class:(0,i.C_)(e.$style.switcher)},[e.loading?((0,a.wg)(),(0,a.iD)("a",J,"检测中")):e.modelValue?((0,a.wg)(),(0,a.iD)("a",{key:2,href:"javascript:",onClick:t[1]||(t[1]=t=>e.$emit("update:modelValue",0))},"关闭自动滚动")):((0,a.wg)(),(0,a.iD)("a",{key:1,href:"javascript:",onClick:t[0]||(t[0]=(...t)=>e.enable&&e.enable(...t))},(0,i.zw)(e.gameNotFound?"未检测到支持的原神窗口，当前暂未支持云游戏等，点击重试":e.denied?"您拒绝了自动滚动所需的权限申请，点击重试":"当前需要进行部分手动操作，点我启用自动滚动"),1))],2),((0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[e.showModel?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,i.C_)(e.$style.modelBackdrop)},[(0,a._)("div",Q,[(0,a._)("div",G,[(0,a.Uk)((0,i.zw)(e.needUpdate?"您的客户端版本过低":"自动滚动需要客户端")+" ",1),e.needUpdate?((0,a.wg)(),(0,a.iD)("small",X,"(v"+(0,i.zw)(e.version)+")",1)):(0,a.kq)("",!0)]),(0,a._)("div",K,[ee,te,(0,a._)("button",{onClick:t[2]||(t[2]=(...t)=>e.enable&&e.enable(...t))},(0,i.zw)(e.loading?"检测中":e.needUpdate?"我已更新并重新运行客户端":"我已下载并运行客户端"),1),(0,a._)("a",{class:"cancel",href:"javascript:",onClick:t[3]||(t[3]=t=>e.showModel=!1)},"取消")])])],2)):(0,a.kq)("",!0)]))])}var ae=(0,a.aZ)({props:{modelValue:Number,w:{type:Object,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const n=(0,O.Vh)(e,"w"),a=(0,O.iH)(!1),i=(0,O.iH)(!1),r=(0,O.iH)(!1),s=(0,O.iH)(!1),o=(0,O.iH)(!1),l=(0,O.iH)(""),u=async()=>{if(a.value)return;a.value=!0;const e=await n.value.check();if(!e)return i.value=!0,a.value=!1,void(o.value=!1);if("1.0.4"!==n.value.version)return o.value=!0,i.value=!0,a.value=!1,void(l.value=n.value.version);o.value=!1;try{const e=await n.value.authorize();if(e){let e=await n.value.listWindows();if(e=e.filter((e=>(e.title.includes("原神")||e.title.toLowerCase().includes("genshin"))&&"UnityWndClass"===e.classname)),0===e.length)return i.value=!1,a.value=!1,void(s.value=!0);t("update:modelValue",e[0].hWnd)}else r.value=!0}catch(u){}i.value=!1,a.value=!1};return{loading:a,showModel:i,enable:u,denied:r,gameNotFound:s,needUpdate:o,version:l}}}),ie={switcher:"switcher-ec23e1",modelBackdrop:"model-backdrop-eb3a6e"};const re={};re["$style"]=ie;const se=(0,H.Z)(ae,[["render",ne],["__cssModules",re]]);var oe=se,le=n(21277),ue=n(86022),ce=n.n(ue),de=n(86463),he=n.n(de),fe=n(13065),ve=n(14287),we=n(75444),pe=n(1607),me=n(72660),ge=n(49095);async function ye(e,t,n){await e(!1);const a=performance.now();await e(await t()),await n();const i=performance.now();return await new Promise(((n,r)=>{const s=async()=>{const o=performance.now();o-a>=1e3&&r(new Error("Latency measurement timeout"));const l=await e(t());l>10?n({latency:o-i,result:l,captureReady:a,controlSent:i,diffFound:o}):requestAnimationFrame(s)};requestAnimationFrame(s)}))}async function be(e,t,{timeout:n=3e4,interval:a=0}){await e(!1);const i=performance.now();await e(t()),await new Promise(((r,s)=>{const o=async()=>{const a=performance.now();a-i>=n&&s(new Error("Measurement timeout"));const o=await e(t());o>10?r({latency:a-i,result:o,captureReady:i,diffFound:a}):l()},l=()=>{0==a?requestAnimationFrame(o):setTimeout(o,a)};l()}))}const Ee=new S,{scannerOnLine:_e,scannerOnLine2:ke,scannerOnImage:$e,initPromise:Ce,workerCV:De,workerOCR:xe}=(0,T.zG)();var Se;(function(e){e[e["Fail"]=-1]="Fail",e[e["Init"]=0]="Init",e[e["Ready"]=1]="Ready",e[e["Request"]=2]="Request",e[e["Wait"]=3]="Wait",e[e["Capture"]=4]="Capture",e[e["Processing"]=5]="Processing",e[e["Finish"]=6]="Finish"})(Se||(Se={})),pe.vI.add(ve.ik8,we.EPy);var Me=(0,a.aZ)({name:"AchievementScanner",components:{FloatWindow:W,FloatContent:j.Z,FloatContentB:B,WebcontrolSwitch:oe,FooterComponent:ge.Z,Loader:me.Z},setup(){const e=(0,fe.yj)(),t=(0,O.iH)(0),n=window===parent,i=(0,O.iH)(!1),r=(0,O.iH)([]),s=(0,O.iH)(0),o=(0,O.iH)(0),l=(0,a.Fl)((()=>({success:r.value.filter((e=>e.success)).length,fail:r.value.filter((e=>!e.success)).length}))),u=async({line:t,thread:n})=>{if(t){let a=_e;n&&g.value===Se.Processing&&(w.concurrency=2,a=ke);const i=await a(t);if(i.success){const n=r.value.find((e=>{if(!e.success)return!1;const t=e;return t.achievement.id===i.achievement.id}));i.done&&!e.query.withImage||(i.images={main:(0,M.rT)(t).toDataURL()}),n?o.value++:r.value.push(i)}else i.images={main:(0,M.rT)(t).toDataURL()},r.value.push(i),(new Image).src=i.images.main}g.value!==Se.Processing&&await ce()(400)},c=document.createElement("canvas"),d=c.getContext("2d");let h=null,f=0;const v=async({imageData:e,keepLastLine:n})=>{const a=await $e((0,M.Q8)(e),n),i=s.value,r=a.reduce(((e,t)=>e+t.image.rows),0);let o=0;for(const t of a)t.image.rows>r/a.length*2/3&&((!h||o<2)&&(h=t,o++),w.push({line:t.image,thread:s.value%2===0}),s.value++);if(n&&w.push({line:null,thread:!1}),t.value&&(i===s.value?f++:f=Math.max(0,f-1),f>5))return f=0,void(g.value=Se.Processing)},w=he().promise(u,1);w.drain=()=>{g.value===Se.Processing&&(g.value=Se.Finish)};const p=he().promise(v,1),m=(0,O.iH)(null),g=(0,O.iH)(Se.Init);Ce.then((()=>{g.value=Se.Ready}));let y=null;const b=async()=>{try{y=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}),m.value.srcObject=y,m.value.play(),g.value=Se.Wait}catch(e){console.error("Error: "+e),g.value=Se.Fail}},E=async()=>{c.width=m.value.videoWidth,c.height=m.value.videoHeight;let e=null,n={x:0,y:0},a=-1;const i=async(i=!0)=>{e||(e=await De.getRect()),h&&e&&(n.x&&n.y||(n=await Ee.toAbsolute(t.value,e.x,e.y+h.y+2*h.image.rows/3,{dx:c.width,dy:c.height})),await Ee.SetCursorPos(n.x,n.y),await Ee.mouse_event(Ee.MOUSEEVENTF_LEFTDOWN,0,0,0),await Ee.mouse_event(Ee.MOUSEEVENTF_LEFTUP,0,0,0),i?await Ee.mouse_event(Ee.MOUSEEVENTF_WHEEL,0,0,-120,11):await Ee.mouse_event(Ee.MOUSEEVENTF_WHEEL,0,0,-120,2)),i&&await ce()(a>0?a:60)},r=async()=>{console.log("->latency measurement start");const e=await ye(De.diffCached,(()=>{let e=null;while(!e)console.info("-> capture"),d&&d.drawImage(m.value,0,0,c.width,c.height),e=d&&d.getImageData(0,0,c.width,c.height),e||console.warn("->capture FAILD");return(0,M.Q8)(e)}),(()=>i(!1)));console.log("->latency measurement done",e),a=Math.min(130,Math.max(e.latency,40))};let s=!0;while(g.value===Se.Capture)try{let e=null;while(!e)d&&d.drawImage(m.value,0,0,c.width,c.height),e=d&&d.getImageData(0,0,c.width,c.height),e||(console.warn("->capture FAILD"),await ce()(60));p.push({imageData:e,keepLastLine:!1}),t.value?s?(await ce()(60),await i(!1),await ce()(100),s=!1):await(a>0?i():r()):(await be(De.diffCached,(()=>{let e=null;while(!e)console.info("-> wait for change"),d&&d.drawImage(m.value,0,0,c.width,c.height),e=d&&d.getImageData(0,0,c.width,c.height),e||console.warn("->capture FAILD");return(0,M.Q8)(e)}),{interval:150}),console.log("->changed"))}catch(o){o instanceof Error&&"ECANCEL"===o.message&&(g.value=Se.Processing)}};(0,a.YP)((()=>g.value),(async()=>{if(g.value===Se.Ready&&((0,le.l)("ready",null),(0,le.l)("state","ready")),g.value===Se.Capture&&((0,le.l)("state","capture"),t.value&&Ee.activeWindow(t.value),console.log("capture"),E()),g.value===Se.Processing){d&&d.drawImage(m.value,0,0,c.width,c.height);const e=d&&d.getImageData(0,0,c.width,c.height);e&&p.push({imageData:e,keepLastLine:!0}),y&&y.getTracks().forEach((e=>e.stop())),console.log("processing"),(0,le.l)("state","processing"),w.resume(),t.value&&Ee.hwnd&&Ee.activeWindow(Ee.hwnd)}g.value===Se.Finish&&(console.log("finish"),(0,le.l)("state","finish"),(0,le.l)("result",{result:r.value,dup:o.value}))}));const _=async()=>{await Promise.all([De.reset(),xe.reset()]),r.value=[],s.value=0,o.value=0,g.value=Se.Ready,h=null,f=0},k=e=>{const{event:t}=e.data;switch(t){case"reset":_();break;case"start":b();break}};return n||(window.addEventListener("message",k),(0,a.Jd)((()=>{window.removeEventListener("message",k)}))),(0,a.YP)([s,l,o],(()=>{(0,le.l)("progress",{scanned:s.value,...l.value,dup:o.value})})),{S:Se,state:g,video:m,requestCapture:b,results:r,scanned:s,recognized:l,capture:i,dup:o,isTop:n,reset:_,webControl:Ee,webControlEnabled:t}}}),Te={loader:"loader-ed1218",scannerCssloadLoader:"scanner-cssload-loader-a98e2b",scannerCssloadLoaderInner:"scanner-cssload-loader-inner-a4c871",floatwindow:"floatwindow-b2c0ef",statusInner:"status-inner-e6d784",list:"list-b4ed89",startPage:"start-page-b85619"};const Oe={};Oe["$style"]=Te;const Pe=(0,H.Z)(Me,[["render",$],["__cssModules",Oe]]);var Fe=Pe},49095:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(19812),i=n(55893);const r=(0,a.Uk)(" 椰羊·成就扫描 | "),s=(0,a._)("a",{href:"https://github.com/YuehaiTeam/cocogoat-web",target:"_blank"},"Github",-1),o=(0,a.Uk)(" | "),l=(0,a._)("a",{href:"https://github.com/YuehaiTeam/cocogoat-web/tree/main/docs",target:"_blank"},"集成文档",-1),u=(0,a.Uk)(" | ");function c(e,t,n,c,d,h){const f=(0,a.up)("build-info");return(0,a.wg)(),(0,a.iD)("div",{class:(0,i.C_)(e.$style.opensource)},[r,s,o,l,u,(0,a.Wm)(f)],2)}var d=n(45161),h={components:{BuildInfo:d.Z}},f={opensource:"opensource-ac4c5a"},v=n(48998);const w={};w["$style"]=f;const p=(0,v.Z)(h,[["render",c],["__cssModules",w]]);var m=p},97690:function(e,t,n){"use strict";e.exports=n.p+"img/openscreenshare.a7389a8f.png"},77610:function(e,t,n){"use strict";n(13910),n(33950)}}]);